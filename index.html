<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>This is for you</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Mali:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <style>
        /* Estilos base */
        body, html {
            height: 100%;
            margin: 0;
            padding: 0;
            background-color: #000;
            color: #FFF;
            font-family: 'Mali', 'Courier New', monospace;
            overflow: hidden;
        }

        /* Canvas para el efecto 3D (ocupa todo el fondo) */
        #three-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0; /* Capa más baja */
        }

        /* Contenedor principal centrado */
        .container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            height: 100%;
            width: 100%;
            position: absolute;
            top: 0;
            left: 0;
        }

        /* 1. Pantalla de "Clic para empezar" */
        #click-overlay {
            cursor: pointer;
            z-index: 20; /* Encima de todo */
        }
        
        #click-overlay h1 {
            font-size: 2.5rem;
            color: #f0f0f0;
            margin-bottom: 20px;
            animation: pulse 2s infinite ease-in-out;
        }

        #click-overlay p {
            font-size: 1.2rem;
            color: #aaa;
        }

        /* 2. Contenido del Mensaje (oculto al inicio) */
        #message-content {
            display: none;
            z-index: 10; /* Encima de los efectos */
        }

        /* El Mensaje principal */
        .message {
            font-size: 5rem;
            font-weight: bold;
            color: #EE66A6;
            text-shadow: 0 0 10px #EE66A6, 0 0 20px #EE66A6, 0 0 30px #f7a;
            animation: glow 1.5s infinite alternate, 
                         breath 4s infinite alternate ease-in-out;
            white-space: pre-wrap;
        }

        /* Botón de control de audio */
        .btn-audio-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 100;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            color: white;
            font-size: 1.2rem;
            display: none; /* Oculto al inicio */
        }

        .btn-audio-toggle:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }

        /* Palabras flotantes estilo LoveLoom */
        .floating-words {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 5; /* Entre el fondo 3D y el mensaje */
        }

        .floating-word {
            position: absolute;
            font-size: 1.2rem;
            color: #EE66A6;
            font-weight: 600;
            opacity: 0;
            text-shadow: 0 0 8px rgba(238, 102, 166, 0.5);
            /* Animación CSS para flotar */
            animation: floatWord 15s infinite linear;
        }

        /* Animaciones */
        @keyframes glow {
            from { text-shadow: 0 0 10px #EE66A6, 0 0 20px #EE66A6, 0 0 30px #f7a; }
            to { text-shadow: 0 0 20px #EE66A6, 0 0 30px #f7a, 0 0 40px #f7a; }
        }

        @keyframes breath {
            from { transform: scale(1); }
            to { transform: scale(1.03); }
        }

        @keyframes pulse {
            0% { opacity: 0.7; }
            50% { opacity: 1; }
            100% { opacity: 0.7; }
        }

        /* Animación de las palabras flotantes */
        @keyframes floatWord {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% { opacity: 0.8; }
            90% { opacity: 0.8; }
            100% {
                transform: translateY(-100px) rotate(360deg);
                opacity: 0;
            }
        }

        /* Responsivo para celulares */
        @media (max-width: 600px) {
            .message { font-size: 3rem; }
            #click-overlay h1 { font-size: 1.8rem; }
            .floating-word { font-size: 1rem; }
        }
    </style>
</head>
<body>

    <canvas id="three-canvas"></canvas>
    
    <audio id="myAudio" loop>
        <source src="https://a128-z3.zmdcdn.me/d5e48d317636af55834b87b0fd9fd5fe?authen=exp=1762399955~acl=/d5e48d317636af55834b87b0fd9fd5fe*~hmac=537e951475297463e4a86ebf0646086e" type="audio/mpeg">
        Tu navegador no soporta el audio.
    </audio>

    <button id="toggle-audio" class="btn-audio-toggle">
        <i id="audio-icon" class="fa-solid fa-volume-high"></i>
    </button>

    <div class="floating-words" id="floating-words"></div>

    <div class="container" id="click-overlay">
        <h1>Toca para empezar</h1>
        <p>(Se necesita un clic para iniciar la música)</p>
    </div>

    <div class="container" id="message-content">
        <div class="message"></div> </div>

    <script>
        // --- SECCIÓN 1: LÓGICA DE INICIO ---

        const overlay = document.getElementById('click-overlay');
        const messageContent = document.getElementById('message-content');
        const messageElement = document.querySelector('.message');
        const audio = document.getElementById('myAudio');
        const toggleAudioBtn = document.getElementById('toggle-audio');
        const audioIcon = document.getElementById('audio-icon');
        const floatingWordsContainer = document.getElementById('floating-words');
        
        let isPlaying = false;
        let threeScene, threeCamera, threeRenderer, threeParticles;

        // Texto para la máquina de escribir
        const originalText = "I LOVE YOU SO MUCH\nMY ALEJ";

        // Lista de palabras románticas
        const romanticWords = [
            "LOVE", "AMOR", "TI AMO", "TE QUIERO", "FOREVER", 
            "ETERNITY", "SOULMATE", "DESTINY", "PASSION", "ROMANCE",
            "ADORE", "CHERISH", "HEART", "SOUL", "TOGETHER", "ALWAYS", 
            "BEAUTIFUL", "PERFECT", "ANGEL", "DREAM", "MAGIC", "KISS", "HUG"
        ];

        // INICIO: Al hacer clic en la pantalla
        overlay.addEventListener('click', () => {
            audio.play();
            isPlaying = true;
            toggleAudioBtn.style.display = 'block';
            overlay.style.display = 'none';
            messageContent.style.display = 'flex';
            
            initThreeScene();     // Inicia el fondo 3D
            startFloatingWords(); // Inicia las palabras flotantes
            startTypewriter();    // Inicia el efecto de máquina de escribir
        });

        // Control de audio
        toggleAudioBtn.addEventListener('click', () => {
            if (isPlaying) {
                audio.pause();
                audioIcon.className = 'fa-solid fa-volume-xmark';
            } else {
                audio.play();
                audioIcon.className = 'fa-solid fa-volume-high';
            }
            isPlaying = !isPlaying;
        });

        // --- SECCIÓN 2: PALABRAS FLOTANTES (CSS) ---

        function startFloatingWords() {
            // Crear palabras flotantes continuamente
            setInterval(createFloatingWord, 800); // Nueva palabra cada 800ms

            // Llenar la pantalla con algunas palabras iniciales
            for (let i = 0; i < 15; i++) {
                setTimeout(createFloatingWord, i * 300);
            }
        }

        function createFloatingWord() {
            const word = document.createElement('div');
            word.className = 'floating-word';
            
            const randomWord = romanticWords[Math.floor(Math.random() * romanticWords.length)];
            word.textContent = randomWord;
            
            word.style.left = (Math.random() * 85 + 5) + '%';
            word.style.fontSize = (Math.random() * 0.8 + 0.7) + 'rem';
            word.style.opacity = (Math.random() * 0.4 + 0.4);
            
            const duration = Math.random() * 10 + 20; // 20s a 30s
            word.style.animationDuration = duration + 's';
            word.style.animationDelay = (Math.random() * 5) + 's';
            
            const hue = Math.random() * 20 + 320; // Tonos rosas
            word.style.color = `hsl(${hue}, 70%, 70%)`;
            
            floatingWordsContainer.appendChild(word);
            
            // Eliminar palabra después de que termine la animación
            setTimeout(() => {
                word.remove();
            }, (duration + 5) * 1000); // Espera a que termine la anim + delay
        }

        // --- SECCIÓN 3: EFECTO MÁQUINA DE ESCRIBIR ---

        function startTypewriter() {
            let i = 0;
            messageElement.textContent = ''; // Asegura que esté vacío
            
            const typeWriter = () => {
                if (i < originalText.length) {
                    messageElement.textContent += originalText.charAt(i);
                    i++;
                    setTimeout(typeWriter, 100); // Velocidad de escritura
                }
            };
            setTimeout(typeWriter, 500); // Espera medio segundo antes de escribir
        }

        // --- SECCIÓN 4: FONDO 3D (THREE.JS) ---

        function initThreeScene() {
            threeScene = new THREE.Scene();
            
            threeCamera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            threeCamera.position.z = 5;
            
            threeRenderer = new THREE.WebGLRenderer({ 
                canvas: document.getElementById('three-canvas'),
                alpha: true, // Fondo transparente
                antialias: true
            });
            threeRenderer.setSize(window.innerWidth, window.innerHeight);
            threeRenderer.setClearColor(0x000000, 0); // Fondo negro transparente
            
            // Crear partículas 3D
            const particleCount = 500;
            const positions = new Float32Array(particleCount * 3);
            const colors = new Float32Array(particleCount * 3);
            
            for (let i = 0; i < particleCount * 3; i += 3) {
                positions[i] = (Math.random() - 0.5) * 50;
                positions[i + 1] = (Math.random() - 0.5) * 50;
                positions[i + 2] = (Math.random() - 0.5) * 50;
                
                colors[i] = 0.93; // R (rosa)
                colors[i + 1] = 0.4;  // G
                colors[i + 2] = 0.65; // B
            }
            
            const geometry = new THREE.BufferGeometry();
            geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            geometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));
            
            const material = new THREE.PointsMaterial({
                size: 0.1,
                vertexColors: true,
                transparent: true,
                opacity: 0.8
            });
            
            threeParticles = new THREE.Points(geometry, material);
            threeScene.add(threeParticles);
            
            // Iniciar animación 3D
            animateThree();
        }

        function animateThree() {
            requestAnimationFrame(animateThree);
            
            // Nube de partículas rotatoria
            threeParticles.rotation.x += 0.0005;
            threeParticles.rotation.y += 0.001;

            // Movimiento sutil de la cámara
            threeCamera.position.x = Math.sin(Date.now() * 0.0003) * 2;
            threeCamera.position.y = Math.cos(Date.now() * 0.0002) * 1;
            threeCamera.lookAt(threeScene.position);
            
            threeRenderer.render(threeScene, threeCamera);
        }
        
        // Ajustar todo si la ventana cambia de tamaño
        window.addEventListener('resize', () => {
            canvasWidth = window.innerWidth;
            canvasHeight = window.innerHeight;

            // Ajustar 3D
            if (threeRenderer) {
                threeCamera.aspect = canvasWidth / canvasHeight;
                threeCamera.updateProjectionMatrix();
                threeRenderer.setSize(canvasWidth, canvasHeight);
            }
        });

    </script>
</body>
</html>
